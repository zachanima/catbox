"use strict";

var GameText = Component.extend({

  awoken: false,


  Awake: function() {
    //Make new canvas
    this.canvas = document.createElement('canvas');
    this.canvas.width = 800;
    this.canvas.height = 480;
    this.context = this.canvas.getContext('2d');
    this.context.textAlign = 'center';
    this.context.font = "40pt '5X5-B___'";

    //Make first gradient (rainbow)
    this.grad = this.context.createLinearGradient(350, 0, 500, 0);
    this.grad.addColorStop(0, 'red');
    this.grad.addColorStop(1 / 2, 'green');
    this.grad.addColorStop(1, 'blue');

    //Make second gradient (fade in)
    this.whiteOverlay = this.context.createLinearGradient(0, 0, 0, 130);
    this.whiteOverlay.addColorStop(0, 'black');
    this.whiteOverlay.addColorStop(1, 'rgba(0,0,0,0)');

    var _this = this;
    setTimeout(function() {
      _this.awoken = true;
    }, 100);
  },



  Update: function() {
    if (this.awoken && this.transform.position.y < 130) {
      this.transform.position.y += 0.5;
    }
  },



  OnGUI: function() {
    
    this.context.clearRect(0, 0, 800, 480);
    this.context.fillStyle = '#fff';

    this.context.fillText(
      this.text<
      this.transform.position.x,
      this.transform.position.y
    );


    this.context.globalCompositeOperation = 'source-in';
    this.context.fillStyle = this.grad;
    this.context.fillRect(this.transform.position.x-120, this.transform.position.y-100, 240, 100);
    this.context.fillStyle = this.whiteOverlay;
    this.context.globalCompositeOperation = 'source-atop';
    this.context.fillRect(this.transform.position.x-120, this.transform.position.y-100, 240, 100);
    window.context.drawImage(this.canvas, 0, 0);
    this.context.globalCompositeOperation = 'source-over';
  }
});
